/*
* Kendo UI Beta v2012.3.1322 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

("function"==typeof define&&define.amd?define:function(t,o){return o()})(["./kendo.core.min","./kendo.popup.min"],function(){(function(t){function o(t){for(;t.length;)e(t),t=t.parent()}function e(t){var o=t.data(r.ns+"title");o&&(t.attr("title",o),t.removeData(r.ns+"title"))}function i(t){var o=t.attr("title");o&&(t.data(r.ns+"title",o),t.removeAttr("title"))}function n(t){for(;t.length;)i(t),t=t.parent()}var r=window.kendo,s=r.ui.Widget,a=r.ui.Popup,l=t.isFunction,c=t.isPlainObject,p=t.extend,u=t.proxy,f=r.isLocalUrl,h="_tt_active",d="aria-describedby",m="show",g="hide",v="error",w="contentLoad",k="k-content-frame",_='<div role="tooltip" class="k-widget k-tooltip" style="margin-left:0.5em">#if (!autoHide) {# <div class="k-tooltip-button"><a href="\\#">close</a></div> #}#<div class="k-tooltip-content"></div>#if (callout){ #<div class="k-callout k-callout-#=dir#"></div>#}#</div>',b=r.template("<iframe frameborder='0' class='"+k+"' "+"src='#= content.url #'>"+"This page requires frames in order to show content"+"</iframe>"),T=".kendoTooltip",y={bottom:{origin:"bottom center",position:"top center"},top:{origin:"top center",position:"bottom center"},left:{origin:"center left",position:"center right",collision:"fit flip"},right:{origin:"center right",position:"center left",collision:"fit flip"},center:{position:"center center",origin:"center center"}},x={top:"bottom",bottom:"top",left:"right",right:"left",center:"center"},H={bottom:"n",top:"s",left:"e",right:"w",center:"n"},O={horizontal:{offset:"top",size:"height"},vertical:{offset:"left",size:"width"}},j=function(t){return t.element.data(r.ns+"title")},A=s.extend({init:function(t,o){var e,i=this;s.fn.init.call(i,t,o),e=i.options.position.match(/left|right/)?"horizontal":"vertical",i.dimensions=O[e],i.element.on(i.options.showOn+T,i.options.filter,u(i._showOn,i)).on("mouseenter"+T,i.options.filter,u(i._mouseenter,i)),this.options.autoHide&&i.element.on("mouseleave"+T,i.options.filter,u(i._mouseleave,i))},options:{name:"Tooltip",filter:"",content:j,showAfter:100,callout:!0,position:"bottom",showOn:"mouseenter",autoHide:!0,animation:{open:{effects:"fade:in",duration:0},close:{effects:"fade:out",duration:100}}},events:[m,g,w,v],_mouseenter:function(o){n(t(o.currentTarget))},_showOn:function(o){var e=this;e.options.showOn&&e.options.showOn.match(/click|focus/)?e.show(t(o.currentTarget)):(clearTimeout(e.timeout),e.timeout=setTimeout(function(){e.show(t(o.currentTarget))},e.options.showAfter))},_appendContent:function(t){var o,e=this,i=e.options.content,n=e.content,s=e.options.iframe;c(i)&&i.url?("iframe"in e.options||(s=!f(i.url)),s?(n.hide(),o=n.find("."+k)[0],o?o.src=i.url||o.src:n.html(b({content:i})),n.find("."+k).unbind("load"+T).on("load"+T,function(){e.trigger(w),n.show()})):(n.empty(),r.ui.progress(n,!0),e._ajaxRequest(i))):i&&l(i)?(i=i({element:t}),e.content.html(i)):e.content.html(i)},_ajaxRequest:function(t){var o=this;jQuery.ajax(p({type:"GET",dataType:"html",cache:!1,error:function(t,e){r.ui.progress(o.content,!1),o.trigger(v,{status:e,xhr:t})},success:u(function(t){r.ui.progress(o.content,!1),o.content.html(t),o.trigger(w)},o)},t))},hide:function(){this.popup&&this.popup.close()},show:function(t){var e=this,i=e.target();e.popup||e._initPopup(),i&&i[0]!=t[0]&&e.popup.close(),i&&i[0]==t[0]||(e._appendContent(t),e.popup.options.anchor=t),e.popup.one("deactivate",function(){o(t),t.removeAttr(d),this.element.removeAttr("id").attr("aria-hidden",!0)}),e.popup.open()},_initPopup:function(){var o=this,e=o.options,i=t(r.template(_)({callout:e.callout&&"center"!==e.position,dir:H[e.position],autoHide:e.autoHide}));o.popup=new a(i,p({activate:function(){var t=this.options.anchor,i=t[0].id||o.element[0].id;i&&(t.attr(d,i+h),this.element.attr("id",i+h)),e.callout&&o._positionCallout(),this.element.removeAttr("aria-hidden"),o.trigger(m)},close:function(){o.trigger(g)},animation:e.animation},y[e.position])),i.css({width:e.width,height:e.height}),o.content=i.find(".k-tooltip-content"),o.arrow=i.find(".k-callout"),e.autoHide?i.on("mouseleave"+T,u(o._mouseleave,o)):i.on("click"+T,".k-tooltip-button",u(o.hide,o))},_mouseleave:function(e){if(this.popup){var i=t(e.currentTarget),n=i.offset(),r=e.pageX,s=e.pageY;if(n.right=n.left+i.outerWidth(),n.bottom=n.top+i.outerHeight(),r>n.left&&n.right>r&&s>n.top&&n.bottom>s)return;this.popup.close()}else o(t(e.currentTarget));clearTimeout(this.timeout)},_positionCallout:function(){var o=this,e=o.options.position,i=o.dimensions,n=i.offset,r=o.popup,s=r.options.anchor,a=t(s).offset(),l=t(r.element).offset(),c=H[r.flipped?x[e]:e],p=a[n]-l[n]+t(s)[i.size]()/2;o.arrow.removeClass("k-callout-n k-callout-s k-callout-w k-callout-e").addClass("k-callout-"+c).css(n,p)},target:function(){return this.popup?this.popup.options.anchor:null},destroy:function(){var t=this.popup;t&&(t.element.off(T),t.destroy()),this.element.off(T),s.fn.destroy.call(this)}});r.ui.plugin(A)})(window.kendo.jQuery)});